#!/bin/bash

##
# Primarily used to run nightly code analysis of the CVS repository.
# But, I <i>still></i> like source control, so I checked it in.  Now there
# is at least "some" documentation and a backup...
# <p>
# HERE IS mevans' crontab entry on FEARFACTORY:
# </p><pre>
# [mevans@fearfactory mevans]$ crontab -l
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.17065 installed on Fri Aug 30 01:12:19 2002)
# (Cron version -- $Id: cron_run_analysis 20101 2011-03-06 16:02:15Z bhagn $)
# SHELL=/bin/bash
# MAILTO=mevans@envenergy.com
# CVSROOT=:ext:mevans@cvs.envenergy.com:/home/cvs
# CVS_RSH=ssh
# BROADWAY_PROPERTIES=/home/mevans/config/broadway.properties
# 0 4 * * * $HOME/bin/cron_run_analysis 2>&1
# [mevans@fearfactory mevans]$ 
# </pre>
# <p>
# INSTALLATION (AT LEAST FOR mevans ON FEARFACTORY):
# </p><pre>
# [mevans@fearfactory mevans]$ pushd .
# [mevans@fearfactory mevans]$ cd /tmp
# [mevans@fearfactory tmp]$ cvs co broadway/tools/cron_run_analysis
# [mevans@fearfactory tmp]$ cp broadway/tools/cron_run_analysis ~/bin/
# [mevans@fearfactory tmp]$ rm -rf broadway
# [mevans@fearfactory tmp]$ popd
# ~
# [mevans@fearfactory mevans]$
# </pre>
# @fixme Combine CVS checkout for all automated development processes.

set -xv # "Debug" should be enabled for cron jobs!
TMPDIR=/tmp/$$
mkdir ${TMPDIR} || exit 1
BAILSCRIPT="(cd /tmp ; rm -rf ${TMPDIR} ; exit 1) || exit 1"
cd ${TMPDIR} || eval ${BAILSCRIPT}
cvs co broadway/tools/analyze_from_cvs || eval ${BAILSCRIPT}
cd broadway/tools || eval ${BAILSCRIPT}
./analyze_from_cvs || eval ${BAILSCRIPT}
cd /tmp
rm -rf ${TMPDIR}
exit 0
