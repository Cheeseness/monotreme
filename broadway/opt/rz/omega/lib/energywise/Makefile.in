#=--------------------------------------------------------------------------=#
#
# Template Makefile.in for Envenergy Broadway builds.
# Stolen by Mark M. Evans from S.T. Mansfield (smansfield@envenergy.com)
#
# @configure_input@
#=--------------------------------------------------------------------------=#



#=--------------------------------------------------------------------------=#
#=-                DO NOT CHANGE ANYTHING BELOW THIS LINE                  -=#
#=--------------------------------------------------------------------------=#
# NOTE: This section of the makefile is generated by update_makefile.py in   #
#       the root directory of the broadway source tree.  By doing this,      #
#       it is reasonable to keep the almost 200 makefiles in sync with any   #
#       required changes.  To change this section, modify update_makefile.py #
#       and rerun the update_makefiles script.                               #
#=--------------------------------------------------------------------------=#

srcdir = @srcdir@
top_srcdir = @top_srcdir@
include @BUILD_DIR@/Constants.make

#=--------------------------------------------------------------------------=#
#=-                DO NOT CHANGE ANYTHING ABOVE THIS LINE                  -=#
#=--------------------------------------------------------------------------=#


#=---------------------------------------------------------------------------
# Rule: do_makeall
#
#   Required.  Called by the top level makefile via 'Rules.make', or by a
#   call to 'make' in a subdirectory.  Feel free to add other targets here,
#   but you should leave the 'target' rule.

do_makeall: target tools tests


#=---------------------------------------------------------------------------
# Define your 'prelease(-d)' structure.  See 'config/Rules.make' for a
# discussion of these variables.

PRELEASE:=	rz.omega


#=---------------------------------------------------------------------------
# Include the main 'Rules' file where most of the work is done.  This must
# follow the 'do_makeall' rule and PRELEASE_XXX symbols.

include $(RULES_FILE)

#=---------------------------------------------------------------------------
# Use 'TARGETS' to define what you want built.

TARGETS:=	__init__.$(PYEXT) \
		_address.so \
		energywise_api.$(PYEXT) \
		energywise_manager.$(PYEXT) \
		libewapi.$(PYEXT) \
		_libewapi.so \
		_libewapi.so.0 \
		_libewapi.so.0.6 \
		_libewsdk.so \
		_libewsdk.so.0 \
		_libewsdk.so.0.6
ifeq (@PROCESSOR_FAMILY@,x86)
_libewsdk.so.0.6: $(srcdir)/toolkit/lib/libewsdk.slo.0.6
	cp -f $(srcdir)/toolkit/lib/libewsdk.slo.0.6 _libewsdk.so.0.6
else
_libewsdk.so.0.6: $(srcdir)/megatron_toolkit/lib/libewsdk.so.0.6
	cp -f $(srcdir)/megatron_toolkit/lib/libewsdk.so.0.6 _libewsdk.so.0.6
endif

_libewsdk.so.0: _libewsdk.so.0.6
	ln -fs _libewsdk.so.0.6 _libewsdk.so.0

_libewsdk.so: _libewsdk.so.0
	ln -fs _libewsdk.so.0 _libewsdk.so

ifeq (@PROCESSOR_FAMILY@,x86)
_libewapi.so.0.6: $(srcdir)/toolkit/lib/libewapi.slo.0.6
	cp -f $(srcdir)/toolkit/lib/libewapi.slo.0.6 _libewapi.so.0.6 
else
_libewapi.so.0.6: $(srcdir)/megatron_toolkit/lib/libewapi.so.0.6
	cp -f $(srcdir)/megatron_toolkit/lib/libewapi.so.0.6 _libewapi.so.0.6 
endif

_libewapi.so.0: _libewapi.so.0.6
	ln -fs _libewapi.so.0.6 _libewapi.so.0

_libewapi.so: _libewapi.so.0
	ln -fs _libewapi.so.0 _libewapi.so

_address.so: _address.o
	$(LD) -shared -o $@ _address.o $(LDFLAGS)

target: $(TARGETS)

#=---------------------------------------------------------------------------
# Use 'DOCUMENTATION' to define documentation that needs to be generated.

DOC:=		

doc: $(DOC)

#=---------------------------------------------------------------------------
# Use 'TOOLS' to define utility programs.  Output from this rule will *not*
# be included in a 'prelease(-d)' invocation.

TOOLS:=		

tools: $(TOOLS)

#=---------------------------------------------------------------------------
# Use 'TESTS' to define test programs.  Any programs here will also be
# invoked when 'make unittest' is run.  Output from this rule will *not*
# be included in a 'prelease(-d)' invocation.

TESTS:=		

tests: $(TESTS)

#=--------------------------------------------------------------------------=#
# Local Variables:
# mode: Makefile
# End:
# vim: ts=4 noexpandtab syntax=make background=dark
#=- EOF --------------------------------------------------------------------=#
